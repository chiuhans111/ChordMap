(function(){"use strict";var e={6559:function(e,n,t){var o=t(9242),a=t(3396),i=t(7139);const r={class:"container"},l=(0,a._)("div",null,[(0,a._)("h1",null," Chord Analyzer ")],-1),s={ref:"key selector"},c=["value"],u={ref:"octave selector",value:"4"},m=["value"],d={ref:"chord selector"},h=["value"],p={class:"scroll_horizontal",ref:"scroll region"},y=(0,a._)("div",{class:"scroll_horizontal-sticky"}," â–¼ Piano Keys | Click to play ",-1),f={class:"piano_container-keyboard"},v=["onClick"],_=(0,a._)("div",{class:"scroll_horizontal-sticky"}," â–¼ Chord Switches | Click to toggle on/off ",-1),g={class:"piano_container-editor"},w=["onClick"],k={class:"note_octave"},M=(0,a._)("div",{class:"scroll_horizontal-sticky"}," â–¼ Harmonics | Orange = Overtone, Blue = Undertone | Click to play ",-1),b=["onClick"],x=["onClick"],C=(0,a.uE)('<section><div class="container"><div><h1> How to use? </h1><p>1. Click piano key to play sound.</p><p>2. Toggle the switches to make a chord.</p><p>3. View and interact with harmonics.</p></div></div></section><footer><div class="container"><div><h3>GitHub Repository</h3><p><a href="https://github.com/chiuhans111/ChordMap">github.com/chiuhans111/ChordMap</a></p><h3>Credit:</h3><p>Developer: Hans Chiu</p><p>Chords gathered from <a href="https://www.apassion4jazz.net/keys.html">apassion4jazz.net/keys.html</a></p></div></div></footer>',2);function K(e,n,t,K,j,z){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("section",null,[(0,a._)("div",r,[l,(0,a._)("div",null,[(0,a._)("button",{onClick:n[0]||(n[0]=e=>z.clearAllKeys())},"Clear All Keys"),(0,a._)("select",s,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(j.toneNames,(e=>((0,a.wg)(),(0,a.iD)("option",{value:e,key:e},(0,i.zw)(e),9,c)))),128))],512),(0,a._)("select",u,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)([2,3,4,5,6],(e=>(0,a._)("option",{value:e,key:e},(0,i.zw)(e),9,m))),64))],512),(0,a._)("select",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(j.chordDatabase.chords,((e,n)=>((0,a.wg)(),(0,a.iD)("option",{value:e.keys,key:n},(0,i.zw)(e.name),9,h)))),128))],512),(0,a._)("button",{onClick:n[1]||(n[1]=e=>z.applyChords())},"Apply Chords")]),(0,a._)("div",null,[(0,a._)("button",{onClick:n[2]||(n[2]=e=>z.playEnabledKeys())},"Play Enabled Keys"),(0,a._)("span",null," Pitch Class and ratio = "+(0,i.zw)(j.pitchClass)+", "+(0,i.zw)(j.ratio),1)])])]),(0,a._)("section",null,[(0,a._)("div",p,[y,(0,a._)("div",{class:"piano_container",style:(0,i.j5)({width:j.fullWidth+"px"})},[(0,a._)("div",f,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(j.pianoKeys,(e=>((0,a.wg)(),(0,a.iD)("div",{style:(0,i.j5)(e.keyStyle),class:(0,i.C_)([Object.assign(e.cssClass,{key_enabled:e.enable}),"note_body"]),key:e.index,onClick:(0,o.iM)((n=>z.pianoKeyClick(e)),["prevent"])},null,14,v)))),128))])],4),_,(0,a._)("div",{class:"piano_container",style:(0,i.j5)({width:j.fullWidth+"px"})},[(0,a._)("div",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(j.pianoKeys,(e=>((0,a.wg)(),(0,a.iD)("div",{style:(0,i.j5)(e.containerStyle),class:(0,i.C_)([e.cssClass,"note_box"]),key:e.index,onClick:(0,o.iM)((n=>z.editorKeyClick(e)),["prevent"])},[(0,a._)("div",{class:(0,i.C_)([{note_enable:e.enable},"note_box-tag"])},(0,i.zw)(e.name),3),(0,a._)("span",k,(0,i.zw)(e.octave),1)],14,w)))),128))])],4),M,(0,a._)("div",{class:"ratio_hint",style:(0,i.j5)({width:j.fullWidth+"px"})},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(j.analyzeResult.hints,((e,n)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,i.C_)(["ratio_hint-row",{is_higher_harmonics:e.isHigherHarmonics}]),key:n,onClick:(0,o.iM)((n=>z.playHint(e)),["prevent"])},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.nodes,((n,t)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,i.C_)(["ratio_hint-node",n.cssClass]),style:(0,i.j5)(n.style),key:t,onClick:(0,o.iM)((t=>z.playHint(e,n)),["prevent"])},[n.cssClass["node_is_minimize"]?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a.Uk)((0,i.zw)(n.ratio),1)],64))],14,x)))),128))],10,b)))),128))],4)],512)]),C])}t(6229),t(7330),t(2062),t(7658);let j=[];const z=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],q=[0,0,1,1,2,3,3,4,4,5,5,6],H=[!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!0,!1],T=440,O={};let A=42;for(let pe=0;pe<12;pe++){const e=z[pe];O[e]=pe}function D(e,n){return O[e]+12*n}function S(e){return T*2**((e-V)/12)}function F(e){return 12*Math.log2(e/T)+V}function N(e){return(e+.5)%12-.5}function E(e){return z[Math.round(N(e))]}const U=D("C",2),R=D("B",7),I=(R-U+1)*A,V=D("A",4);for(let pe=U;pe<=R;pe++){const e=z[pe%12],n=H[pe%12],t={name:e,index:pe,octave:Math.floor(pe/12),isWhiteKey:!n,isBlackKey:n,frequency:S(pe),enable:!1,containerStyle:{position:"absolute"},keyStyle:{position:"absolute"},cssClass:{note_is_white:!n,note_is_black:n}};j.push(t)}function P(e){return(e-U)*A}function W(){const e=12*A,n=e/7;for(let t of j){let e=P(t.index);if(t.containerStyle.left=e+"px",t.containerStyle.width=A+"px",t.isWhiteKey){const o=q[t.index%12]*n,a=t.index%12*A;t.keyStyle.left=e+o-a+"px",t.keyStyle.width=n+"px"}else t.keyStyle.left=e+"px",t.keyStyle.width=A+"px"}}W();var $={pianoKeys:j,toneNames:z,frequency2index:F,wrapToneNumber:N,nearestToneName:E,keyid_start:U,keyid_end:R,index2Xoffset:P,fullWidth:I,name2index:D};let L=null;function Y(e,n,t,o,a,i,r){const l=e.createGain();return l.gain.setValueAtTime(0,e.currentTime),l.gain.linearRampToValueAtTime(n,e.currentTime+t),l.gain.linearRampToValueAtTime(n*a,e.currentTime+t+o),l.gain.linearRampToValueAtTime(n*a,e.currentTime+r-i),l.gain.linearRampToValueAtTime(0,e.currentTime+r),l}let B=[];function G(e,n){L||(L=new(window.AudioContext||window.webkitAudioContext)),B.splice(0,B.length);for(let t of e){const e=L.createOscillator();e.type="sine",e.frequency.setValueAtTime(t,L.currentTime);const o=Y(L,.2,.001,.1,.5,.1,n);e.connect(o),o.connect(L.destination),e.start(L.currentTime),e.stop(L.currentTime+n),B.push(e)}}var X={playNotes:G};function J(e){let n="ðŸ˜„";return e>2.5&&(n="ðŸ˜€"),e>4.5&&(n="ðŸ˜Š"),e>5.5&&(n="ðŸ˜”"),e>8.5&&(n="ðŸ˜ž"),e>12.5&&(n="ðŸ˜¢"),n}function Z(e,n){return Array.isArray(e)?0==e.length?1:1==e.length?e[0]:Z(e[0],Z(e.slice(1))):0===n?e:Z(n,e%n)}function Q(e,n){return Array.isArray(e)?0==e.length?0:1==e.length?e[0]:Q(e[0],Q(e.slice(1))):e*n/Z(e,n)}function ee(e){return e.map((e=>{while(e%2==0)e>>=1;return e}))}function ne(e,n){const t=Q(n),o=Math.log2(t),a=e.map((e=>12*Math.log2(e))),i=n.map((e=>12*Math.log2(e))),r=a.map(((e,n)=>e-i[n])).reduce(((e,n)=>e+n),0)/a.length,l=2**(r/12),s=a.map(((e,n)=>e-r-i[n])),c=Math.sqrt(s.map((e=>e*e)).reduce(((e,n)=>e+n),0)/s.length),u=12*o,m=Math.min(...i)<=u/2,d=Math.max(...i)>=u/2,h=n.map((e=>t/e)),p=Math.log2(Q(ee(n))),y=Math.log2(Math.min(...n,...h)),f=Math.log2(Math.min(n.reduce(((e,n)=>e+n))/n.length,h.reduce(((e,n)=>e+n))/h.length)),v=c<.15&&o<20&&y<6,_=.0025919*+c+.97270508*o+1*p+.25572689*y+.25703505*f;return{valid:v,merits:{rmse:c,log_complexity:o,log_min_complexity:p,log_r0:y,log_r1:f},lcm:t,isOvertone:m,isUndertone:d,merit:_,commonFrequency:l}}function te(e=[]){let n=[];if(0==e.length)return[];if(1==e.length)n.push({ratio:[1],lcm:1,commonFrequency:e[0],rmse:0,merit:0,isOvertone:!0,isUndertone:!0});else{let t={};const o=Math.min(...e);let a=e.map((e=>Math.floor(e/o)));for(let r=0;r<50;r++){const o=Math.max(...e.map(((e,n)=>e/(a[n]+1))));a=e.map((e=>Math.round(e/o)));const i=Z(a),r=a.map((e=>e/i)),l=r.join(":");if(!t[l]){t[l]=!0;const o=ne(e,r);o.valid&&n.push({ratio:r.map((e=>e)),lcm:o.lcm,commonFrequency:o.commonFrequency,merit:o.merit,isOvertone:o.isOvertone,isUndertone:o.isUndertone,merits:o.merits})}}const i=Math.max(...e);a=e.map((e=>Math.floor(i/e)));for(let r=0;r<40;r++){const o=Math.min(...e.map(((e,n)=>e*(a[n]+1))));a=e.map((e=>Math.round(o/e)));const i=a.reduce(((e,n)=>e*n),1),r=a.map((e=>Math.round(i/e))),l=Z(r),s=r.map((e=>e/l)),c=s.join(":");if(!t[c]){t[c]=!0;const o=ne(e,s);o.valid&&n.push({ratio:s.map((e=>e)),lcm:o.lcm,commonFrequency:o.commonFrequency,rmse:o.rmse,merit:o.merit,isOvertone:o.isOvertone,isUndertone:o.isUndertone})}}}return n.sort(((e,n)=>e.merit-n.merit)),Object.freeze(n),n.slice(0,4)}function oe(e=[]){let n=te(e),t=[];for(let i=0;i<n.length;i++){const e=n[i],o=0==i?4:1;if(e.isOvertone)for(let n=1;n<=o;n++)t.push({ratio:e.ratio.map((e=>e*n)),lcm:e.lcm*n,commonFrequency:e.commonFrequency/n,isHigherHarmonics:n>1,isOvertone:!0,isUndertone:!1});if(e.isUndertone)for(let n=1;n<=o;n++)t.push({ratio:e.ratio,lcm:e.lcm*n,commonFrequency:e.commonFrequency,isHigherHarmonics:n>1,isOvertone:!1,isUndertone:!0})}let o=[];for(let i of t){if(i.isOvertone){let e=[];const n=Math.max(35,...i.ratio);for(let t=1;t<=n;t++){const n=t*i.commonFrequency,o=$.frequency2index(n),a=i.ratio.includes(t);o<$.keyid_start-1||o>$.keyid_end+1||(a||t<100)&&e.push({ratio:t,frequency:n,index:o,isKey:a,style:{position:"absolute",left:$.index2Xoffset(o+.5)+"px"},cssClass:{node_is_key:a,node_is_minimize:!a&&t>35||i.isHigherHarmonics,node_is_overtone:!0,node_is_factor:i.lcm%t==0}})}o.push({nodes:e,ratio:i.ratio,frequencies:i.ratio.map((e=>e*i.commonFrequency)),isHigherHarmonics:i.isHigherHarmonics})}if(i.isUndertone){let e=[];const n=i.ratio.map((e=>i.lcm/e)),t=Math.max(35,...n);for(let o=1;o<=t;o++){const t=i.lcm/o,a=t*i.commonFrequency,r=$.frequency2index(a),l=n.includes(o);r<$.keyid_start-1||r>$.keyid_end+1||(l||o<100)&&e.push({ratio:o,frequency:a,index:r,isKey:l,style:{position:"absolute",left:$.index2Xoffset(r+.5)+"px"},cssClass:{node_is_key:l,node_is_minimize:!l&&o>35||i.isHigherHarmonics,node_is_undertone:!0,node_is_factor:i.lcm%o==0}})}o.push({nodes:e,ratio:i.ratio,frequencies:i.ratio.map((e=>e*i.commonFrequency)),isHigherHarmonics:i.isHigherHarmonics})}}const a={frequencies:e,results:n,hints:o};return Object.freeze(a),a}var ae={analyze:oe,ratio2emoji:J};function ie(e,n,t,o=300){let a=e.scrollLeft,i=e.scrollTop,r=n-a,l=t-i;function s(){u=!0,e.removeEventListener("mousedown",s),e.removeEventListener("wheel",s),e.removeEventListener("touchstart",s)}const c=performance.now();let u=!1;function m(){let n=performance.now()-c;n>o&&(u=!0,n=o);let t=n/o;t=Math.sin(t*Math.PI/2)**2,e.scrollTo(t*r+a,t*l+i),u?s():requestAnimationFrame(m)}e.addEventListener("mousedown",s),e.addEventListener("wheel",s),e.addEventListener("touchstart",s),m()}var re={smoothScroll:ie},le=JSON.parse('[{"value":[5,8],"name":"Major"},{"value":[4,8],"name":"Minor"},{"value":[8],"name":"5"},{"value":[5,8,11],"name":"Dominant 7th"},{"value":[5,8,12],"name":"Major 7th"},{"value":[4,8,11],"name":"Minor 7th"},{"value":[4,8,12],"name":"Minor Major 7th"},{"value":[6,8],"name":"Sus 4"},{"value":[3,8],"name":"Sus 2"},{"value":[5,8,10],"name":"6"},{"value":[4,8,10],"name":"Minor 6"},{"value":[5,8,11,3],"name":"9"},{"value":[4,8,11,3],"name":"Minor 9"},{"value":[5,8,12,3],"name":"Major 9"},{"value":[4,8,12,3],"name":"Minor Major 9"},{"value":[5,8,11,3,6],"name":"11"},{"value":[4,8,11,3,6],"name":"Minor 11"},{"value":[5,8,12,3,6],"name":"Major 11"},{"value":[4,8,12,3,6],"name":"Minor Major 11"},{"value":[5,8,11,3,10],"name":"13"},{"value":[4,8,11,3,10],"name":"Minor 13"},{"value":[5,8,12,3,10],"name":"Major 13"},{"value":[4,8,12,3,10],"name":"Minor Major 13"},{"value":[5,8,3],"name":"add 9"},{"value":[4,8,3],"name":"Minor add 9"},{"value":[5,8,10,3],"name":"6 add 9"},{"value":[4,8,10,3],"name":"Minor 6 add 9"},{"value":[5,8,11,6],"name":"Dominant 7th add 11"},{"value":[5,8,12,6],"name":"Major 7th add 11"},{"value":[4,8,11,6],"name":"Minor 7th add 11"},{"value":[4,8,12,6],"name":"Minor Major 7th add 11"},{"value":[5,8,11,10],"name":"Dominant 7th add 13"},{"value":[5,8,12,10],"name":"Major 7th add 13"},{"value":[4,8,11,10],"name":"Minor 7th add 13"},{"value":[4,8,12,10],"name":"Minor Major 7th add 13"},{"value":[5,7,11],"name":"7b5"},{"value":[5,9,11],"name":"7#5"},{"value":[5,8,11,2],"name":"7b9"},{"value":[5,8,11,4],"name":"7#9"},{"value":[5,9,11,2],"name":"7#5b9"},{"value":[4,7,11],"name":"m7b5"},{"value":[4,9,11],"name":"m7#5"},{"value":[4,8,11,2],"name":"m7b9"},{"value":[5,8,11,3,7],"name":"9#11"},{"value":[5,8,11,3,9],"name":"9b13"},{"value":[6,8,10],"name":"6sus4"},{"value":[6,8,11],"name":"7sus4"},{"value":[6,8,12],"name":"Major 7th Sus4"},{"value":[6,8,11,3],"name":"9sus4"},{"value":[6,8,12,3],"name":"Major 9 Sus4"}]');let se=[];for(let pe of le){let e=[];for(let n of pe.value){if(e.length>0)while(n<e[e.length-1])n+=12;e.push(n)}se.push({name:pe.name,keys:[0,e.map((e=>e-1))]})}var ce={chords:se};console.log(ce);var ue={name:"App",data(){return{pianoKeys:$.pianoKeys,toneNames:$.toneNames,fullWidth:$.fullWidth,analyzeResult:{},pitchClass:[],ratio:[],chordDatabase:ce}},components:{},mounted(){const e=new URLSearchParams(window.location.search),n=e.get("keys");try{const e=n.split(",").map((e=>parseInt(e))).filter((e=>!isNaN(e)));if(e.length>0){for(let n of this.pianoKeys)n.enable=e.includes(n.index);this.updateAnalyze(),this.scrollKeyIntoView()}else console.log("no keys"),this.scrollToKeyIndex(($.keyid_start+$.keyid_end)/2)}catch(t){console.log("parameter parsing failed"),this.scrollToKeyIndex(($.keyid_start+$.keyid_end)/2)}console.log("keys:",n)},methods:{clearAllKeys(){for(let e of this.pianoKeys)e.enable=!1;this.updateAnalyze()},applyChords(){const e=this.$refs["key selector"],n=this.$refs["octave selector"],t=this.$refs["chord selector"],o=e.value,a=n.value,i=t.value.split(",").map((e=>parseInt(e))),r=$.name2index(o,a);for(let l of this.pianoKeys)l.enable=i.includes(l.index-r);this.scrollKeyIntoView(),this.updateAnalyze(),this.playEnabledKeys()},pianoKeyClick(e){X.playNotes([e.frequency],.5)},scrollToKeyIndex(e){let n=$.index2Xoffset(e),t=this.$refs["scroll region"].offsetWidth;re.smoothScroll(this.$refs["scroll region"],n-t/2,0)},scrollKeyIntoView(){let e=this.pianoKeys.filter((e=>e.enable)).map((e=>e.index));this.scrollToKeyIndex((Math.min(...e)+Math.max(...e))/2+.5)},editorKeyClick(e){e.enable=!e.enable,X.playNotes([e.frequency],.5),this.updateAnalyze()},playEnabledKeys(){X.playNotes($.pianoKeys.filter((e=>e.enable)).map((e=>e.frequency)),.5)},updateAnalyze(){this.updateParams(),this.analyzeResult=ae.analyze($.pianoKeys.filter((e=>e.enable)).map((e=>e.frequency)));let e=$.pianoKeys.filter((e=>e.enable)).map((e=>e.index));e=e.map((n=>n-e[0])),this.pitchClass=e,this.analyzeResult.hints.length>0?this.ratio=this.analyzeResult.hints[0].ratio:this.ratio=[]},updateParams(){const e=$.pianoKeys.filter((e=>e.enable)).map((e=>e.index)).join(","),n=`${window.location.protocol}//${window.location.host}${window.location.pathname}?keys=${e}`;window.history.pushState({},"",n)},playHint(e,n){void 0===n?X.playNotes(e.frequencies,.5):X.playNotes([n.frequency],.5),this.ratio=e.ratio}},computed:{}},me=t(89);const de=(0,me.Z)(ue,[["render",K]]);var he=de;(0,o.ri)(he).mount("#app")}},n={};function t(o){var a=n[o];if(void 0!==a)return a.exports;var i=n[o]={exports:{}};return e[o].call(i.exports,i,i.exports,t),i.exports}t.m=e,function(){var e=[];t.O=function(n,o,a,i){if(!o){var r=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],i=e[u][2];for(var l=!0,s=0;s<o.length;s++)(!1&i||r>=i)&&Object.keys(t.O).every((function(e){return t.O[e](o[s])}))?o.splice(s--,1):(l=!1,i<r&&(r=i));if(l){e.splice(u--,1);var c=a();void 0!==c&&(n=c)}}return n}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,a,i]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={143:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var a,i,r=o[0],l=o[1],s=o[2],c=0;if(r.some((function(n){return 0!==e[n]}))){for(a in l)t.o(l,a)&&(t.m[a]=l[a]);if(s)var u=s(t)}for(n&&n(o);c<r.length;c++)i=r[c],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(u)},o=self["webpackChunkchordmap"]=self["webpackChunkchordmap"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(6559)}));o=t.O(o)})();
//# sourceMappingURL=app.0e239977.js.map