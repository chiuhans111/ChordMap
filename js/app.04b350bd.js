(function(){"use strict";var e={9750:function(e,n,t){var o=t(9242),a=t(3396),i=t(7139);const l={class:"container"},r=(0,a._)("div",null,[(0,a._)("h1",null," Chord Analyzer ")],-1),s={class:"selector-wrapper"},c=(0,a._)("span",{class:"selector-label"},"Key",-1),u={ref:"key selector"},m=["value"],d={class:"selector-wrapper"},h=(0,a._)("span",{class:"selector-label"},"Octave",-1),p={ref:"octave selector",value:"4"},y=["value"],f={class:"selector-wrapper"},v=(0,a._)("span",{class:"selector-label"},"Chord",-1),_={ref:"chord selector"},g=["value"],w={class:"scroll_horizontal",ref:"scroll region"},k=(0,a._)("div",{class:"scroll_horizontal-sticky"}," â–¼ Piano Keys | Click to play ",-1),M={class:"piano_container-keyboard"},b=["onClick"],x=(0,a._)("div",{class:"scroll_horizontal-sticky"}," â–¼ Chord Switches | Click to toggle on/off ",-1),C={class:"piano_container-editor"},K=["onClick"],j={class:"note_octave"},z=(0,a._)("div",{class:"scroll_horizontal-sticky"}," â–¼ Harmonics | Orange = Overtone, Blue = Undertone | Click to play ",-1),q=["onClick"],H=["onClick"],O=(0,a.uE)('<section><div class="container"><div><h1> How to use? </h1><p>1. Click piano key to play sound.</p><p>2. Toggle the switches to make a chord.</p><p>3. View and interact with harmonics.</p></div></div></section><footer><div class="container"><div><h3>GitHub Repository</h3><p><a href="https://github.com/chiuhans111/ChordMap">github.com/chiuhans111/ChordMap</a></p><h3>Credit:</h3><p>Developer: Hans Chiu</p><p>Chords gathered from <a href="https://www.apassion4jazz.net/keys.html">apassion4jazz.net/keys.html</a></p></div></div></footer>',2);function T(e,n,t,T,A,D){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("section",null,[(0,a._)("div",l,[r,(0,a._)("div",null,[(0,a._)("button",{onClick:n[0]||(n[0]=e=>D.clearAllKeys())},"Clear All Keys"),(0,a.Uk)(" Chord Preset: "),(0,a._)("span",s,[c,(0,a._)("select",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.toneNames,(e=>((0,a.wg)(),(0,a.iD)("option",{value:e,key:e},(0,i.zw)(e),9,m)))),128))],512)]),(0,a._)("span",d,[h,(0,a._)("select",p,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)([2,3,4,5,6],(e=>(0,a._)("option",{value:e,key:e},(0,i.zw)(e),9,y))),64))],512)]),(0,a._)("span",f,[v,(0,a._)("select",_,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.chordDatabase.chords,((e,n)=>((0,a.wg)(),(0,a.iD)("option",{value:e.keys,key:n},(0,i.zw)(e.name),9,g)))),128))],512)]),(0,a._)("button",{onClick:n[1]||(n[1]=e=>D.applyChords())},"Apply!")]),(0,a._)("div",null,[(0,a._)("button",{class:"btn-hightlight",onClick:n[2]||(n[2]=e=>D.playEnabledKeys())},"Play Enabled Keys"),(0,a._)("span",null," Pitch Class and ratio = "+(0,i.zw)(A.pitchClass)+", "+(0,i.zw)(A.ratio),1)])])]),(0,a._)("section",null,[(0,a._)("div",w,[k,(0,a._)("div",{class:"piano_container",style:(0,i.j5)({width:A.fullWidth+"px"})},[(0,a._)("div",M,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.pianoKeys,(e=>((0,a.wg)(),(0,a.iD)("div",{style:(0,i.j5)(e.keyStyle),class:(0,i.C_)([Object.assign(e.cssClass,{key_enabled:e.enable}),"note_body"]),key:e.index,onClick:(0,o.iM)((n=>D.pianoKeyClick(e)),["prevent"])},null,14,b)))),128))])],4),x,(0,a._)("div",{class:"piano_container",style:(0,i.j5)({width:A.fullWidth+"px"})},[(0,a._)("div",C,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.pianoKeys,(e=>((0,a.wg)(),(0,a.iD)("div",{style:(0,i.j5)(e.containerStyle),class:(0,i.C_)([e.cssClass,"note_box"]),key:e.index,onClick:(0,o.iM)((n=>D.editorKeyClick(e)),["prevent"])},[(0,a._)("div",{class:(0,i.C_)([{note_enable:e.enable},"note_box-tag"])},(0,i.zw)(e.name),3),(0,a._)("span",j,(0,i.zw)(e.octave),1)],14,K)))),128))])],4),z,(0,a._)("div",{class:"ratio_hint",style:(0,i.j5)({width:A.fullWidth+"px"})},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.analyzeResult.hints,((e,n)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,i.C_)(["ratio_hint-row",{is_higher_harmonics:e.isHigherHarmonics}]),key:n,onClick:(0,o.iM)((n=>D.playHint(e)),["prevent"])},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.nodes,((n,t)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,i.C_)(["ratio_hint-node",n.cssClass]),style:(0,i.j5)(n.style),key:t,onClick:(0,o.iM)((t=>D.playHint(e,n)),["prevent"])},[n.cssClass["node_is_minimize"]?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a.Uk)((0,i.zw)(n.ratio),1)],64))],14,H)))),128))],10,q)))),128))],4)],512)]),O])}t(6229),t(7330),t(2062),t(7658);let A=[];const D=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],S=[0,0,1,1,2,3,3,4,4,5,5,6],F=[!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!0,!1],N=440,U={};let E=42;for(let we=0;we<12;we++){const e=D[we];U[e]=we}function $(e,n){return U[e]+12*n}function R(e){return N*2**((e-B)/12)}function I(e){return 12*Math.log2(e/N)+B}function P(e){return(e+.5)%12-.5}function V(e){return D[Math.round(P(e))]}const W=$("C",2),L=$("B",7),Y=(L-W+1)*E,B=$("A",4);for(let we=W;we<=L;we++){const e=D[we%12],n=F[we%12],t={name:e,index:we,octave:Math.floor(we/12),isWhiteKey:!n,isBlackKey:n,frequency:R(we),enable:!1,containerStyle:{position:"absolute"},keyStyle:{position:"absolute"},cssClass:{note_is_white:!n,note_is_black:n}};A.push(t)}function G(e){return(e-W)*E}function X(){const e=12*E,n=e/7;for(let t of A){let e=G(t.index);if(t.containerStyle.left=e+"px",t.containerStyle.width=E+"px",t.isWhiteKey){const o=S[t.index%12]*n,a=t.index%12*E;t.keyStyle.left=e+o-a+"px",t.keyStyle.width=n+"px"}else t.keyStyle.left=e+"px",t.keyStyle.width=E+"px"}}X();var J={pianoKeys:A,toneNames:D,frequency2index:I,wrapToneNumber:P,nearestToneName:V,keyid_start:W,keyid_end:L,index2Xoffset:G,fullWidth:Y,name2index:$};let Z=null;function Q(e,n,t,o,a,i,l){const r=e.createGain();return r.gain.setValueAtTime(0,e.currentTime),r.gain.linearRampToValueAtTime(n,e.currentTime+t),r.gain.linearRampToValueAtTime(n*a,e.currentTime+t+o),r.gain.linearRampToValueAtTime(n*a,e.currentTime+l-i),r.gain.linearRampToValueAtTime(0,e.currentTime+l),r}let ee=[];function ne(e,n){Z||(Z=new(window.AudioContext||window.webkitAudioContext)),ee.splice(0,ee.length);for(let t of e){const e=Z.createOscillator();e.type="sine",e.frequency.setValueAtTime(t,Z.currentTime);const o=Q(Z,.2,.001,.1,.5,.1,n);e.connect(o),o.connect(Z.destination),e.start(Z.currentTime),e.stop(Z.currentTime+n),ee.push(e)}}var te={playNotes:ne};function oe(e){let n="ðŸ˜„";return e>2.5&&(n="ðŸ˜€"),e>4.5&&(n="ðŸ˜Š"),e>5.5&&(n="ðŸ˜”"),e>8.5&&(n="ðŸ˜ž"),e>12.5&&(n="ðŸ˜¢"),n}function ae(e,n){return Array.isArray(e)?0==e.length?1:1==e.length?e[0]:ae(e[0],ae(e.slice(1))):0===n?e:ae(n,e%n)}function ie(e,n){return Array.isArray(e)?0==e.length?0:1==e.length?e[0]:ie(e[0],ie(e.slice(1))):e*n/ae(e,n)}function le(e){return e.map((e=>{while(e%2==0)e>>=1;return e}))}function re(e,n){const t=ie(n),o=Math.log2(t),a=e.map((e=>12*Math.log2(e))),i=n.map((e=>12*Math.log2(e))),l=a.map(((e,n)=>e-i[n])).reduce(((e,n)=>e+n),0)/a.length,r=2**(l/12),s=a.map(((e,n)=>e-l-i[n])),c=Math.sqrt(s.map((e=>e*e)).reduce(((e,n)=>e+n),0)/s.length),u=12*o,m=Math.min(...i)<=u/2,d=Math.max(...i)>=u/2,h=n.map((e=>t/e)),p=Math.log2(ie(le(n))),y=Math.log2(Math.min(...n,...h)),f=Math.log2(Math.min(n.reduce(((e,n)=>e+n))/n.length,h.reduce(((e,n)=>e+n))/h.length)),v=c<.15&&o<20&&y<6,_=.0025919*+c+.97270508*o+1*p+.25572689*y+.25703505*f;return{valid:v,merits:{rmse:c,log_complexity:o,log_min_complexity:p,log_r0:y,log_r1:f},lcm:t,isOvertone:m,isUndertone:d,merit:_,commonFrequency:r}}function se(e=[]){let n=[];if(0==e.length)return[];if(1==e.length)n.push({ratio:[1],lcm:1,commonFrequency:e[0],rmse:0,merit:0,isOvertone:!0,isUndertone:!0});else{let t={};const o=Math.min(...e);let a=e.map((e=>Math.floor(e/o)));for(let l=0;l<50;l++){const o=Math.max(...e.map(((e,n)=>e/(a[n]+1))));a=e.map((e=>Math.round(e/o)));const i=ae(a),l=a.map((e=>e/i)),r=l.join(":");if(!t[r]){t[r]=!0;const o=re(e,l);o.valid&&n.push({ratio:l.map((e=>e)),lcm:o.lcm,commonFrequency:o.commonFrequency,merit:o.merit,isOvertone:o.isOvertone,isUndertone:o.isUndertone,merits:o.merits})}}const i=Math.max(...e);a=e.map((e=>Math.floor(i/e)));for(let l=0;l<40;l++){const o=Math.min(...e.map(((e,n)=>e*(a[n]+1))));a=e.map((e=>Math.round(o/e)));const i=a.reduce(((e,n)=>e*n),1),l=a.map((e=>Math.round(i/e))),r=ae(l),s=l.map((e=>e/r)),c=s.join(":");if(!t[c]){t[c]=!0;const o=re(e,s);o.valid&&n.push({ratio:s.map((e=>e)),lcm:o.lcm,commonFrequency:o.commonFrequency,rmse:o.rmse,merit:o.merit,isOvertone:o.isOvertone,isUndertone:o.isUndertone})}}}return n.sort(((e,n)=>e.merit-n.merit)),Object.freeze(n),n.slice(0,4)}function ce(e=[]){let n=se(e),t=[];for(let i=0;i<n.length;i++){const e=n[i],o=0==i?4:1;if(e.isOvertone)for(let n=1;n<=o;n++)t.push({ratio:e.ratio.map((e=>e*n)),lcm:e.lcm*n,commonFrequency:e.commonFrequency/n,isHigherHarmonics:n>1,isOvertone:!0,isUndertone:!1});if(e.isUndertone)for(let n=1;n<=o;n++)t.push({ratio:e.ratio,lcm:e.lcm*n,commonFrequency:e.commonFrequency,isHigherHarmonics:n>1,isOvertone:!1,isUndertone:!0})}let o=[];for(let i of t){if(i.isOvertone){let e=[];const n=Math.max(35,...i.ratio);for(let t=1;t<=n;t++){const n=t*i.commonFrequency,o=J.frequency2index(n),a=i.ratio.includes(t);o<J.keyid_start-1||o>J.keyid_end+1||(a||t<100)&&e.push({ratio:t,frequency:n,index:o,isKey:a,style:{position:"absolute",left:J.index2Xoffset(o+.5)+"px"},cssClass:{node_is_key:a,node_is_minimize:!a&&t>35||i.isHigherHarmonics,node_is_overtone:!0,node_is_factor:i.lcm%t==0}})}o.push({nodes:e,ratio:i.ratio,frequencies:i.ratio.map((e=>e*i.commonFrequency)),isHigherHarmonics:i.isHigherHarmonics})}if(i.isUndertone){let e=[];const n=i.ratio.map((e=>i.lcm/e)),t=Math.max(35,...n);for(let o=1;o<=t;o++){const t=i.lcm/o,a=t*i.commonFrequency,l=J.frequency2index(a),r=n.includes(o);l<J.keyid_start-1||l>J.keyid_end+1||(r||o<100)&&e.push({ratio:o,frequency:a,index:l,isKey:r,style:{position:"absolute",left:J.index2Xoffset(l+.5)+"px"},cssClass:{node_is_key:r,node_is_minimize:!r&&o>35||i.isHigherHarmonics,node_is_undertone:!0,node_is_factor:i.lcm%o==0}})}o.push({nodes:e,ratio:i.ratio,frequencies:i.ratio.map((e=>e*i.commonFrequency)),isHigherHarmonics:i.isHigherHarmonics})}}const a={frequencies:e,results:n,hints:o};return Object.freeze(a),a}var ue={analyze:ce,ratio2emoji:oe};function me(e,n,t,o=300){let a=e.scrollLeft,i=e.scrollTop,l=n-a,r=t-i;function s(){u=!0,e.removeEventListener("mousedown",s),e.removeEventListener("wheel",s),e.removeEventListener("touchstart",s)}const c=performance.now();let u=!1;function m(){let n=performance.now()-c;n>o&&(u=!0,n=o);let t=n/o;t=Math.sin(t*Math.PI/2)**2,e.scrollTo(t*l+a,t*r+i),u?s():requestAnimationFrame(m)}e.addEventListener("mousedown",s),e.addEventListener("wheel",s),e.addEventListener("touchstart",s),m()}var de={smoothScroll:me},he=JSON.parse('[{"value":[5,8],"name":"Major"},{"value":[4,8],"name":"Minor"},{"value":[8],"name":"5"},{"value":[5,8,11],"name":"Dominant 7th"},{"value":[5,8,12],"name":"Major 7th"},{"value":[4,8,11],"name":"Minor 7th"},{"value":[4,8,12],"name":"Minor Major 7th"},{"value":[6,8],"name":"Sus 4"},{"value":[3,8],"name":"Sus 2"},{"value":[5,8,10],"name":"6"},{"value":[4,8,10],"name":"Minor 6"},{"value":[5,8,11,3],"name":"9"},{"value":[4,8,11,3],"name":"Minor 9"},{"value":[5,8,12,3],"name":"Major 9"},{"value":[4,8,12,3],"name":"Minor Major 9"},{"value":[5,8,11,3,6],"name":"11"},{"value":[4,8,11,3,6],"name":"Minor 11"},{"value":[5,8,12,3,6],"name":"Major 11"},{"value":[4,8,12,3,6],"name":"Minor Major 11"},{"value":[5,8,11,3,10],"name":"13"},{"value":[4,8,11,3,10],"name":"Minor 13"},{"value":[5,8,12,3,10],"name":"Major 13"},{"value":[4,8,12,3,10],"name":"Minor Major 13"},{"value":[5,8,3],"name":"add 9"},{"value":[4,8,3],"name":"Minor add 9"},{"value":[5,8,10,3],"name":"6 add 9"},{"value":[4,8,10,3],"name":"Minor 6 add 9"},{"value":[5,8,11,6],"name":"Dominant 7th add 11"},{"value":[5,8,12,6],"name":"Major 7th add 11"},{"value":[4,8,11,6],"name":"Minor 7th add 11"},{"value":[4,8,12,6],"name":"Minor Major 7th add 11"},{"value":[5,8,11,10],"name":"Dominant 7th add 13"},{"value":[5,8,12,10],"name":"Major 7th add 13"},{"value":[4,8,11,10],"name":"Minor 7th add 13"},{"value":[4,8,12,10],"name":"Minor Major 7th add 13"},{"value":[5,7,11],"name":"7b5"},{"value":[5,9,11],"name":"7#5"},{"value":[5,8,11,2],"name":"7b9"},{"value":[5,8,11,4],"name":"7#9"},{"value":[5,9,11,2],"name":"7#5b9"},{"value":[4,7,11],"name":"m7b5"},{"value":[4,9,11],"name":"m7#5"},{"value":[4,8,11,2],"name":"m7b9"},{"value":[5,8,11,3,7],"name":"9#11"},{"value":[5,8,11,3,9],"name":"9b13"},{"value":[6,8,10],"name":"6sus4"},{"value":[6,8,11],"name":"7sus4"},{"value":[6,8,12],"name":"Major 7th Sus4"},{"value":[6,8,11,3],"name":"9sus4"},{"value":[6,8,12,3],"name":"Major 9 Sus4"}]');let pe=[];for(let we of he){let e=[];for(let n of we.value){if(e.length>0)while(n<e[e.length-1])n+=12;e.push(n)}pe.push({name:we.name,keys:[0,e.map((e=>e-1))]})}var ye={chords:pe};console.log(ye);var fe={name:"App",data(){return{pianoKeys:J.pianoKeys,toneNames:J.toneNames,fullWidth:J.fullWidth,analyzeResult:{},pitchClass:[],ratio:[],chordDatabase:ye}},components:{},mounted(){const e=new URLSearchParams(window.location.search),n=e.get("keys");try{const e=n.split(",").map((e=>parseInt(e))).filter((e=>!isNaN(e)));if(e.length>0){for(let n of this.pianoKeys)n.enable=e.includes(n.index);this.updateAnalyze(),this.scrollKeyIntoView()}else console.log("no keys"),this.scrollToKeyIndex((J.keyid_start+J.keyid_end)/2)}catch(t){console.log("parameter parsing failed"),this.scrollToKeyIndex((J.keyid_start+J.keyid_end)/2)}console.log("keys:",n)},methods:{clearAllKeys(){for(let e of this.pianoKeys)e.enable=!1;this.updateAnalyze()},applyChords(){const e=this.$refs["key selector"],n=this.$refs["octave selector"],t=this.$refs["chord selector"],o=e.value,a=n.value,i=t.value.split(",").map((e=>parseInt(e))),l=J.name2index(o,a);for(let r of this.pianoKeys)r.enable=i.includes(r.index-l);this.scrollKeyIntoView(),this.updateAnalyze(),this.playEnabledKeys()},pianoKeyClick(e){te.playNotes([e.frequency],.5)},scrollToKeyIndex(e){let n=J.index2Xoffset(e),t=this.$refs["scroll region"].offsetWidth;de.smoothScroll(this.$refs["scroll region"],n-t/2,0)},scrollKeyIntoView(){let e=this.pianoKeys.filter((e=>e.enable)).map((e=>e.index));this.scrollToKeyIndex((Math.min(...e)+Math.max(...e))/2+.5)},editorKeyClick(e){e.enable=!e.enable,te.playNotes([e.frequency],.5),this.updateAnalyze()},playEnabledKeys(){te.playNotes(J.pianoKeys.filter((e=>e.enable)).map((e=>e.frequency)),.5)},updateAnalyze(){this.updateParams(),this.analyzeResult=ue.analyze(J.pianoKeys.filter((e=>e.enable)).map((e=>e.frequency)));let e=J.pianoKeys.filter((e=>e.enable)).map((e=>e.index));e=e.map((n=>n-e[0])),this.pitchClass=e,this.analyzeResult.hints.length>0?this.ratio=this.analyzeResult.hints[0].ratio:this.ratio=[]},updateParams(){const e=J.pianoKeys.filter((e=>e.enable));if(e.length>0){const n=e.map((e=>e.index)).join(","),t=`${window.location.protocol}//${window.location.host}${window.location.pathname}?keys=${n}`;window.history.replaceState({},"",t)}else{const e=`${window.location.protocol}//${window.location.host}${window.location.pathname}`;window.history.replaceState({},"",e)}},playHint(e,n){void 0===n?te.playNotes(e.frequencies,.5):te.playNotes([n.frequency],.5),this.ratio=e.ratio}},computed:{}},ve=t(89);const _e=(0,ve.Z)(fe,[["render",T]]);var ge=_e;(0,o.ri)(ge).mount("#app")}},n={};function t(o){var a=n[o];if(void 0!==a)return a.exports;var i=n[o]={exports:{}};return e[o].call(i.exports,i,i.exports,t),i.exports}t.m=e,function(){var e=[];t.O=function(n,o,a,i){if(!o){var l=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],i=e[u][2];for(var r=!0,s=0;s<o.length;s++)(!1&i||l>=i)&&Object.keys(t.O).every((function(e){return t.O[e](o[s])}))?o.splice(s--,1):(r=!1,i<l&&(l=i));if(r){e.splice(u--,1);var c=a();void 0!==c&&(n=c)}}return n}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,a,i]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={143:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var a,i,l=o[0],r=o[1],s=o[2],c=0;if(l.some((function(n){return 0!==e[n]}))){for(a in r)t.o(r,a)&&(t.m[a]=r[a]);if(s)var u=s(t)}for(n&&n(o);c<l.length;c++)i=l[c],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(u)},o=self["webpackChunkchordmap"]=self["webpackChunkchordmap"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(9750)}));o=t.O(o)})();
//# sourceMappingURL=app.04b350bd.js.map